const p=7,l=40,s={"content-type":"application/json;charset=UTF-8","X-Auth-Email":ACCOUNT_EMAIL,"X-Auth-Key":API_KEY},r=async()=>{const t=`https://api.cloudflare.com/client/v4/accounts/${ACCOUNT_ID}/pages/projects`;return(await(await fetch(t,{headers:s})).json()).result},i=async t=>{const e=`https://api.cloudflare.com/client/v4/accounts/${ACCOUNT_ID}/pages/projects/${t}/deployments`;return(await(await fetch(e,{headers:s})).json()).result},o=async()=>{const t=await r();for(const e of t){const n=`https://api.cloudflare.com/client/v4/accounts/${ACCOUNT_ID}/pages/projects/${e}/deployments`,a=await i(e.name);for(const c of a.splice(0,40))(Date.now()-new Date(c.created_on))/864e5>7&&await fetch(`${n}/${c.id}`,{method:"DELETE",headers:s})}return new Response("OK",{status:200})};addEventListener("fetch",t=>{t.respondWith(o())}),addEventListener("scheduled",t=>{t.waitUntil(o())});var d=o;export{d as default};
